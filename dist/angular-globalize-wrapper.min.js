/* angular-globalize-wrapper - v0.2.0 - 2016-02-04
   Copyright (c) 2016 Ross Basarevych; Licensed MIT */

"use strict";var glModule=angular.module("globalizeWrapper",[]);glModule.provider("globalizeWrapper",function(){var a="bower_components/cldr-data",b="l10n",c=["currencies.json","ca-gregorian.json","timeZoneNames.json","numbers.json"],d=["currencyData.json","likelySubtags.json","plurals.json","timeData.json","weekData.json"];this.$get=["$q","$http","$rootScope",function(e,f,g){function h(){return q&&r}function i(h){l=h;var i=[],k=[];l.forEach(function(d){for(var e=0;e<c.length;e++)i.push(f.get(a+"/main/"+d+"/"+c[e]));k.push(f.get(b+"/"+d+".json"))});for(var m=0;m<d.length;m++)i.push(f.get(a+"/supplemental/"+d[m]));e.all(i).then(function(a){a.forEach(function(a){angular.merge(o,a.data)}),q=!0,j()})["catch"](function(){g.$broadcast("GlobalizeLoadError")}),e.all(k).then(function(a){a.forEach(function(a){angular.merge(p,a.data)}),r=!0,j()})["catch"](function(){g.$broadcast("GlobalizeLoadError")})}function j(){h()&&(Globalize.load(o),Globalize.loadMessages(p),l.forEach(function(a){m[a]=Globalize(a)}),g.$broadcast("GlobalizeLoadSuccess"),k(l[0]))}function k(a){n=a,g.$broadcast("GlobalizeLocaleChanged")}var l,m={},n=null,o={},p={},q=!1,r=!1;return{isLoaded:h,setLocale:k,getLocale:function(){return n},loadLocales:i,getGlobalize:function(a){return a||(a=n),m[a]},hasMessage:function(a,b){return b||(b=n),"undefined"!=typeof p[b][a]}}}],this.setCldrBasePath=function(b){a=b},this.setL10nBasePath=function(a){b=a},this.setMainResources=function(a){c=a},this.setSupplementalResources=function(a){d=a}}),glModule.filter("glDate",["globalizeWrapper",function(a){return function(b,c,d){if(!angular.isUndefined(b)&&!angular.isUndefined(c)){if(0==b.length||!a.isLoaded())return"";var e=a.getGlobalize(d);return e?e.formatDate(b,c):b}}}]),glModule.filter("glMessage",["globalizeWrapper",function(a){return function(b){if(!angular.isUndefined(b)){if(0==b.length||!a.isLoaded())return"";if(!a.hasMessage(b))return console.log("Missing translation: "+b),b;var c,d;arguments.length>=3?(c=arguments[1],d=arguments[2]):2==arguments.length&&("object"==typeof arguments[1]?c=arguments[1]:d=arguments[1]);var e=a.getGlobalize(d);return e?e.formatMessage(b,c):b}}}]),glModule.filter("glNumber",["globalizeWrapper",function(a){return function(b){if(!angular.isUndefined(b)){if(0==b.length||!a.isLoaded())return"";var c,d;arguments.length>=3?(c=arguments[1],d=arguments[2]):2==arguments.length&&("object"==typeof arguments[1]?c=arguments[1]:d=arguments[1]);var e=a.getGlobalize(d);return e?e.formatNumber(b,c):b}}}]),glModule.filter("glCurrency",["globalizeWrapper",function(a){return function(b,c){if(!angular.isUndefined(b)&&!angular.isUndefined(c)){if(0==b.length||!a.isLoaded())return"";var d,e;arguments.length>=4?(d=arguments[2],e=arguments[3]):3==arguments.length&&("object"==typeof arguments[2]?d=arguments[2]:e=arguments[2]);var f=a.getGlobalize(e);return f?f.formatCurrency(b,c,d):b}}}]);